@model int

@{
    var freightId = Model;
    var userOffers = ViewBag.UserOffers as List<int>;
    var acceptedOffers = ViewBag.AcceptedOffers as List<int>;
    bool userHasOffered = userOffers != null && userOffers.Contains(freightId);
    bool offerAccepted = acceptedOffers != null && acceptedOffers.Contains(freightId);
}

@if (User.Identity.IsAuthenticated)
{
    if (User.IsInRole("Company") || User.IsInRole("Admin") || User.IsInRole("CompanyUser"))
    {
        if (offerAccepted)
        {
            <span class="badge bg-secondary ms-2">Teklif kabul edildi</span>
        }
        else if (userHasOffered)
        {
            <span class="badge bg-warning text-dark ms-2">Zaten teklif verdiniz</span>
        }
        else
        {
            <a class="btn btn-sm btn-outline-success ms-2"
               asp-controller="Offer" asp-action="Create" asp-route-freightId="@freightId">Teklif Ver</a>
        }
    }
}
else
{
    <a href="@Url.Action("Login", "Account")"
       class="text-danger ms-2 text-decoration-none"
       title="Teklif vermek için giriş yapmalısınız">
        <i class="bi bi-box-arrow-in-right me-1"></i> Teklif vermek için giriş yapmalısınız
    </a>
}
